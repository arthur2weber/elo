version: '3.8'

services:
  elo-core:
    build:
      context: .
      dockerfile: docker/elo/Dockerfile
      args:
        GEMINI_CLI_INSTALL: ${GEMINI_CLI_INSTALL:-}
        GEMINI_GCLOUD_COMPONENT: ${GEMINI_GCLOUD_COMPONENT:-}
    restart: unless-stopped
    network_mode: host
    environment:
      - GEMINI_CLI_BIN=${GEMINI_CLI_BIN:-gemini}
      - GEMINI_CLI_ARGS=${GEMINI_CLI_ARGS:-}
      - GEMINI_CLI_PROMPT_ARG=${GEMINI_CLI_PROMPT_ARG:-}
      - GEMINI_API_KEY=${GEMINI_API_KEY:-}
      - GEMINI_API_MODEL=${GEMINI_API_MODEL:-}
      - GEMINI_API_BASE_URL=${GEMINI_API_BASE_URL:-}
      - THINKING_BUDGET=${THINKING_BUDGET:-}
      - CLOUDSDK_CONFIG=/gcloud
    volumes:
      - ./:/app
      - elo_node_modules:/app/node_modules
      - gcloud_config:/gcloud
      - ./logs:/app/logs
      - ./automations:/app/automations

volumes:
  elo_node_modules:
  gcloud_config: